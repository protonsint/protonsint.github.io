<!DOCTYPE html>
<html lang="en">
<head>
  <title>IndiStocks - Google Finance</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  

	
		
	<link rel="stylesheet" href="css/bootstrap.min.css" />
	<link rel="stylesheet" href="css/jquery-ui.min.css" />
	<link rel="stylesheet" href="css/dataTables.bootstrap.min.css">
	<link rel="stylesheet" href="css/jquery.dataTables.yadcf.min.css" />
	<link rel="stylesheet" href="css/style.css">

	
	<script src="js/jquery.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<script src="js/jquery-ui.min.js"></script>
	<script src="js/papaparse.min.js"></script>
	<script src="js/jquery.dataTables.min.js"></script> 
	<script src="js/jquery.dataTables.yadcf.min.js"></script>
	<script src="js/init.js"></script>


	
	
	
	
  <style>
   
  </style>
</head>
<body>

<div id="navSec"></div>

<div class="container">    
  <div class="row">
    <div class="col-sm-12">
			<div id="StockForm" >
			<select id="stockdropdown">
			<option value="NIFTY">Nifty</option>
			<option value="BANKNIFTY">Bank Nifty</option>
			</select>
				  <table id="firstItem"></table>
				<!-- <p>BSE Stocks <input id="bseList" type="text" /></p>
				<p>NSE Stocks <input id="nseList" type="text" /></p>  -->
				<p><input id="submit_btn" type="submit" value="Submit" /></p>
			</div>
			
			
			
<div class="row">
  	  <div  class="table-responsive"> 
		<table id="example" class="table table-striped table-bordered" cellspacing="0" width="100%"></table>
	  </div>
</div>
  
  
			<script>
$(document).ready(function(){



var getColorForPercentage = function(pct) {
	var cfac=(Math.abs(pct)/5);
	var ccode=0;
	if(pct<0)
		ccode='rgba(255,0,0,'+cfac+')';
	else
		ccode='rgba(0,255,0,'+cfac+')';

    return ccode;
}
var stocklist=new Array();

stocklist["NIFTY"]="IDEA,ICICIBANK,TATASTEEL,HEROMOTOCO,LUPIN,ASIANPAINT,INFRATEL,EICHERMOT,TATAMOTORS,HINDALCO,BHARTIARTL,TECHM,ADANIPORTS,BPCL,ULTRACEMCO,TATAPOWER,KOTAKBANK,AMBUJACEM,ONGC,GRASIM,HCLTECH,GAIL,ITC,SUNPHARMA,AUROPHARMA,RELIANCE,CIPLA,TATAMTRDVR,COALINDIA,AXISBANK,ZEEL,BAJAJ-AUTO,BHEL,WIPRO,LT,TCS,HDFCBANK,YESBANK,BOSCHLTD,BANKBARODA,M&M,NTPC,ACC,SBIN,INFY,MARUTI,POWERGRID,HINDUNILVR,INDUSINDBK,DRREDDY,HDFC";



function fetchStocks(){


	//var bseStocks=$("#bseList").val().split(",");
	var bseStocks='';
	//var nseStocks=$("#nseList").val().split(",");
	var nseStocks=stocklist[$("#stockdropdown").val()];

	//alert(nseStocks);
	
	var apiURL="https://www.google.com/finance/info?q="+"BOM:"+bseStocks+",NSE:"+nseStocks;

	$.ajax({
		 url:apiURL,
		 dataType: 'jsonp', // Notice! JSONP <-- P (lowercase)
		 success:function(json){
			 //console.log(json);
			 console.log(json)
			 var jo = json;
			/*var $table = $('#firstItem');
			$table.append("<table><tr><td> Stock ID </td><td> Exchange </td><td> Last Price </td><td> Last Time </td><td> Change  </td><td> Change Percentage </td></tr>");
					//t, e, l, lt, c, cp
					//alert(jo[i].t)
					
			for(var i=0;i<jo.length;i++){
				$table.append("<tr style='background:"+getColorForPercentage(jo[i].cp)+"'><td>"+jo[i].t+"</td><td>"+jo[i].e+"</td><td>"+jo[i].l+"</td><td>"+jo[i].lt+"</td><td>"+jo[i].c+"</td><td>"+jo[i].cp+"</td></tr>");
			}
			
			$table.append("</table>");*/
			
			
			//alert(jo);
			
		var	table =	$('#example').DataTable( {

			"pageLength": 2000,
			// "scrollX": true,		
					
					
					
		data: jo,
		//MKT,SERIES,SYMBOL,SECURITY,PREV_CL_PR,OPEN_PRICE,HIGH_PRICE,LOW_PRICE,CLOSE_PRICE,NET_TRDVAL,NET_TRDQTY,IND_SEC,CORP_IND,TRADES,HI_52_WK,LO_52_WK
		 "columns": [
		 { data: 'e' ,title: "Exchange" },
           { data: 't' ,title: "Stock Code" },
		   { data: 'pcls_fix' ,title: "Prev Close" },
            { data: 'l_fix' ,title: "Last" },
		   //{ data: 'c',title: "Change"  },
            { data: 'c_fix' ,title: "Change" },
            //{ data: 'ccol' ,title: "Change" },
            { data: 'cp' ,title: "Change%" },
           // { data: 'cp_fix' ,title: "cp_fix" },
            //{ data: 'id' ,title: "id" },
            //{ data: 'l' ,title: "Last" },
            //{ data: 'l_cur' ,title: "l_cur" },
			
            { data: 'lt' ,title: "Time" }
			//,
            //{ data: 'lt_dts' ,title: "Change%" },
            //{ data: 'ltt' ,title: "ltt" }
            //{ data: 's' ,title: "Change%" },
            
			
			
			

        ]
		
		
		,
		"columnDefs": [ 

		  {
			"targets": [ 5 ],
			"render": function ( data, type, full, meta ) {
				  return '<span style="background:'+getColorForPercentage(data)+'">'+data+'</span>';
			}
		  }
		  
		  
		  /*,
		  
					{
				"targets": [ 0,9,11,12 ],
				"visible": false
			},			
		  {
			"targets": [ 2 ],
			"render": function ( data, type, full, meta ) {
				  return data+'<a target="_blank" href="https://www.google.com/finance?q=NSE%3A'+data+'">G</a>'+'<a target="_blank"  href="http://chartink.com/stocks/'+data+'.html">C</a>'+'<a target="_blank"  href="https://www.screener.in/company/'+data+'">S</a>';
			}
		  },

		{
			"type": "html-num-fmt", "targets": [8,10,13,16,17,18],
			
		}*/
		  
		]
	} );

		 },
		 error:function(){
			 alert("Error");
		 }      
	});

}


$("#submit_btn").on("click",fetchStocks)
});
</script>
			
    </div>
  </div>
</div>

<div id="footerSec"></div>

</body>
</html>
